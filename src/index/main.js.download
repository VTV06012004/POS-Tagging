(()=>{"use strict";const t=document.querySelector.bind(document),e=document.querySelectorAll.bind(document);function a(a){a.preventDefault();for(const t of e(".nav-tabs li"))t.classList.remove("active");console.log(a.target.parentNode),a.target.parentNode.classList.add("active");for(const t of e(".tab-pane"))t.classList.remove("active");t("#"+a.target.getAttribute("aria-controls")).classList.add("active")}function n(){document.body.classList.remove("mode-view"),document.body.classList.add("mode-edit"),u(t("#tagTipContainer")),t(".histogram").innerHTML=""}function o(){r(!0);var e=t("#text").value;e=(e=e.replace("»",'"')).replace("«",'"');const a=new URLSearchParams;return a.append("text",e),a.append("language",t("#language").value),fetch("/tagger/tagger",{method:"POST",body:a}).then((t=>{t.json().then(s)}),(t=>{console.error(t)})),!1}function s(e){var a=t("#language").value,n=appData[a].tagMap,o=appData[a].posAvailable,s={},c=0;document.body.classList.remove("mode-edit"),document.body.classList.add("mode-view");var l=[];for(const t of o)l.push([t,appData.i18n[name]]);l.sort((function(t,e){return t[1]===e[1]?0:t[1]<e[1]?-1:1})),l=l.map((function(t){return t[0]}));const p=t("#textTagged");p.innerHTML="";var g=e.taggedText.split(" "),u="";for(const t of g){var v=t.substring(t.lastIndexOf("/")+1),f=t.substring(0,t.lastIndexOf("/"));f=(f=(f=f.replace("\\/","/")).replace("-LRB-","(")).replace("-RRB-",")"),"$,"!=v&&"$."!=v&&"''"!=f&&")"!=f&&"``"!=u&&"("!=u&&p.appendChild(document.createTextNode(" ")),u=f,'"'==(f=(f=f.replace("``",'"')).replace("''",'"'))&&(v="");const e=document.createElement("span");e.className="taggedWord",e.textContent=f,e.addEventListener("mouseover",i),e.addEventListener("mouseout",d),e.addEventListener("click",i);var m=n[v];null!=m&&-1!==o.indexOf(m[0])?(e.classList.add("tag"+m[0]),e.setAttribute("data-tag",v),e.setAttribute("data-pos",m[0]),void 0===s[m[0]]?s[m[0]]=1:s[m[0]]++,c++):(e.classList.add("tagOther"),e.setAttribute("data-tag",v)),p.appendChild(e)}t(".histogram").innerHTML="";for(const e of l)if(void 0!==s[e]){var L=Math.round(100*s[e]/c),b='<tr><td class="histogramPos">'+appData.i18n[e]+'</td><td><span class="histogramBar tag'+e+'" style="width: '+.9*L+'%;">&nbsp;</span><span class="histogramPercent">'+L+"&nbsp;%</span></td></tr>";t(".histogram").innerHTML+=b}r(!1)}function i(e){const a=t("#language").value,n=appData[a].tagMap,o=appData[a].posAvailable,s=t("#tagTipContainer"),i=e.target,d=i.getAttribute("data-tag"),r=n[d];if(""==d||null==n[d])return;const c=t("#tagTip");if(""!=r[0]){var l=void 0!==appData.i18n[r[0]]?appData.i18n[r[0]]:r[0],p=r[1],g=r[2],u="<b>"+l+"</b>, "+d;""!=p&&(u+="<br />("+p+")"),null!=g&&""!=g&&(u+="<br />"+appData.i18n.label_examples+" "+g),c.innerHTML=u}else c.innerHTML=d+": "+r[1];var f=-1===o.indexOf(r[0])?"Other":r[0];s.className="",s.classList.add("tag"+f),v(s),s.style.left=i.offsetLeft+"px",s.style.top=i.offsetTop+i.offsetHeight+"px";const m=t("#tagTipContainer .up");m.style.marginLeft=i.offsetWidth/2-m.offsetWidth/2+"px"}function d(e){u(t("#tagTipContainer"))}function r(e){e?document.body.classList.add("loading"):document.body.classList.remove("loading"),t("#text").disabled=e,t("#language").disabled=e,t("#submit").disabled=e}function c(){l(),document.body.classList.contains("mode-view")&&(document.body.classList.remove("mode-view"),document.body.classList.add("mode-edit"),o())}function l(){var a=t("#language").value;g(e("#colors div")),g(e("#posDownload option"));for(const e of appData[a].posAvailable)v(t("#colors div.tag"+e)),v(t("#posDownload option.tag"+e))}function p(){var a=t("#posDownload").value,n="",o=e("#textTagged .taggedWord");for(const t of o)t.getAttribute("data-pos")===a&&(n+=t.textContent+"\n");t("#wordList").value=n,t("#wordListForm").submit()}function g(t){for(const e of t)u(e)}function u(t){t.style.display="none"}function v(t){t.style.display="block"}window.addEventListener("load",(function(){l(),u(t("#tagTipContainer")),t("#submit").addEventListener("click",o),t("#edit").addEventListener("click",n),t("#downloadWords").addEventListener("click",p),t("#language").addEventListener("change",c),t("#montessori").addEventListener("change",(()=>{document.body.classList.toggle("montessori")})),t(".toggle-tools").addEventListener("click",(()=>{document.body.classList.toggle("show-tools")})),window.addEventListener("resize",(()=>{u(t("#tagTipContainer"))})),t("#tagTipContainer").addEventListener("click",(function(){u(t("#tagTipContainer"))})),e(".nav-tabs li a").forEach((t=>{t.addEventListener("click",a)}))}))})();